### Merge these files using QCTOOL
For cases
CEU.out.cases.gen
CEU.out.cases.sample

For controls
CEU.out.controls.gen
CEU.out.controls.sample

### STEP 1
COMMAND
FALE ####./qctool -g CEU.out.controls.gen -s CEU.out.controls.sample -g CEU.out.cases.gen -s CEU.out.cases.sample -og CEU.gen -os CEU.sample
TRUE ./gtool -M --g CEU.out.controls.gen CEU.out.cases.gen --s CEU.out.controls.sample CEU.out.cases.sample --log example/example10_example11.log

It will produce two files. .gen and .sample. Rename them.
CEU.gen "Combined cases and controls data."
CEU.sample "Sample file."

### STEP 2 
In HAPGEN2, controls are identified as 0 and cases as 1. After that, we will be using plink, so we have to convert controls to 1 and cases to 0.
Run the following python script. It will make modification in the CEU.sample file

import pandas as pd
data = pd.read_csv('CEU.sample',delimiter=" ")
print (data)
data.pheno[data.pheno == "1"] = "2"
data.pheno[data.pheno == "0"] = "1"
print (data)
data.to_csv('CEU.sample', index = False,sep="\t")

After this step we will have two files. CEU.gen and CEU.sample.
python changeCaseControls.py

### STEP 3 
Convert CEU.gen and CEU.sample file to CEU.ped and CEU.map file using Gtool. Make your phenotype type column name is correct. In our case, it was "pheno."
./gtool -G --g CEU.gen --s CEU.sample --ped CEU.ped --map CEU.map --phenotype pheno

After this step, we will have two files. CEU.ped and CEU.map.

### STEP 4
Perform association test on CEU.ped and CEU.map file using plink, and it will generate p-values and ODD ration for each snp.

./plink --file CEU --allow-no-sex --fisher

After this step, we will have file plink.assoc.fisher.


### STEP 5
Change the Chromosome number in the file generated by plink.

import pandas as pd
data = pd.read_csv("plink.assoc.fisher",delimiter=r"\s+")
data['CHR'] = 1
data.to_csv("plink.assoc.fisher",index = False)


python preprocessAssociation.py

It will modify the "plink.assoc.fisher" file and change chromosome 0 to chromosome 1, the first column.

### STEP 6
Run this Script in R.
library(qqman)

snp <-read.csv('plink.assoc.fisher')
manhattan(snp,chr = "CHR", bp = "BP", p = "P", snp = "SNP",
          col = c("gray10", "gray60"), chrlabs = NULL, ylim = c(0, 10),
          suggestiveline = -log10(1e-05), genomewideline = -log10(5e-08),
          logp = TRUE, annotatePval = NULL,
          annotateTop = TRUE)


This will generate a manhattan plot.

So we saw how can do thisâ€”CEU.gen file to manhattan plot.



